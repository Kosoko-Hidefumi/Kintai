# Cursorでの実装手順書

各ステップが終わるごとに、Cursor内のターミナルで `git add .` と `git commit` を行う流れで進めます。

## Step 1: プロジェクトの雛形作成

Cursorの Composer (Cmd+I / Ctrl+I) を開き、プロジェクトの土台を一気に作らせます。

### AIへの指示例:

「Streamlitを使用した勤怠管理アプリの雛形を作成してください。.gitignore、requirements.txt、および app.py（サイドバーメニュー付き）を生成して。仮想環境 venv の作成コマンドも教えて。」

### Git Commit:
```
init: プロジェクト構造の初期化
```

---

## Step 2: Google Sheets 接続モジュールの作成

接続情報を `st.secrets` で管理する安全な設計をCursorに書かせます。

### AIへの指示例:

「gspread を使って Google スプレッドシートに接続するための database.py を作成して。認証情報は st.secrets から読み込むようにし、指定したシートを読み書きする関数を用意して。」

### Git Commit:
```
feat: Google Sheets接続基盤の実装
```

---

## Step 3: 7月年度対応の計算ロジック実装

ここがシステムの肝です。Cursorに複雑な年度計算を任せます。

### AIへの指示例:

「日付を受け取ると、『7月〜翌6月』を1つの年度として判定する関数を作成して。また、開始時間と終了時間から取得時間を計算し、8時間で1日として換算するロジックも追加して。」

### Git Commit:
```
feat: 年度判定と日数計算ロジックの実装
```

---

## Step 4: 休暇申請フォームの実装

Cursorに「直感的な入力フォーム」をデザインさせます。

### AIへの指示例:

「app.py に休暇申請フォームを実装して。職員名、日付、種別、時間を選択し、保存時にUUID（固有ID）を付与してスプレッドシートに保存する処理にして。」

### Git Commit:
```
feat: UUID付き休暇申請フォームの実装
```

---

## Step 5: カレンダー表示（streamlit-calendar）の統合

外部ライブラリの組み込みもCursorならスムーズです。

### AIへの指示例:

「streamlit-calendar を使って、スプレッドシートのログをカレンダーに表示して。休暇種別ごとにイベントの色を変えるように設定して。」

### Git Commit:
```
feat: カラー色分けカレンダー表示の実装
```

---

## Step 6: 掲示板機能（最新順表示）の実装

UIの見た目を整える指示を出します。

### AIへの指示例:

「掲示板機能を実装して。新しい投稿が一番上にくるように降順ソートし、Streamlitの container を使って各投稿をカード型の綺麗なデザインで表示して。」

### Git Commit:
```
feat: カード型掲示板（降順ソート）の実装
```

---

## Step 7: 管理者専用「集計画面」の実装

権限による表示制御を組み込みます。

### AIへの指示例:

「サイドバーで管理者としてログイン（パスワード制）した時だけ、『集計画面』メニューが出るようにして。集計画面では年度ごとの各職員の残日数を表形式で表示して。」

### Git Commit:
```
feat: 管理者専用集計ダッシュボードの実装
```

---

## Step 8: ID指定による修正・削除機能の実装

Cursorにスプレッドシートの行を特定して更新するロジックを書かせます。

### AIへの指示例:

「管理者画面に、過去のログを修正・削除できる機能を追加して。event_id をキーにしてスプレッドシートの該当行を探し、上書きまたは削除する処理を書いて。」

### Git Commit:
```
feat: ログの修正・削除機能（CRUD）の実装
```

---

## Step 9: リファクタリングとエラー処理

最後に、AIにコード全体のバグチェックと整理をさせます。

### AIへの指示例:

「コード全体をレビューして。スプレッドシートとの通信エラーが起きた時の例外処理を追加し、動作が軽くなるようにキャッシュ（st.cache_data）を適切に配置して。」

### Git Commit:
```
refactor: エラーハンドリングの強化とコードの最適化
```
