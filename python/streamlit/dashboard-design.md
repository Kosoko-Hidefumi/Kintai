# 顧客購買データ ダッシュボード設計書

## データ概要
- **データ期間**: 2023年1月〜2024年12月
- **レコード数**: 300件
- **主要カラム**: 顧客ID、年齢、性別、地域、購入カテゴリー、購入金額、購入日、支払方法

---

## ダッシュボード全体構成

### 1. トップページ（概要ダッシュボード）

#### 1.1 主要KPI指標（4列表示）
- **総顧客数**: ユニークな顧客IDの数
- **総購入金額**: 全期間の合計購入金額
- **平均購入金額**: 1件あたりの平均購入金額
- **総購入件数**: 全取引件数
- **顧客単価**: 1顧客あたりの平均購入金額
- **月間平均売上**: 月間平均購入金額
- **リピート率**: 複数回購入している顧客の割合
- **成長率**: 前年比または前月比の成長率

#### 1.2 トレンド表示（2列）
- **左**: 月別売上推移（折れ線グラフ）
- **右**: 月別購入件数推移（棒グラフ）

#### 1.3 主要インサイト（3列）
- **左**: 地域別売上シェア（ドーナツチャート）
- **中央**: カテゴリー別売上シェア（ドーナツチャート）
- **右**: 支払方法別シェア（ドーナツチャート）

---

### 2. 顧客分析ページ

#### 2.1 顧客セグメント分析
- **年齢層別分析**
  - 年齢層の定義（例: 10代、20代、30代、40代、50代、60代、70代以上）
  - 年齢層別の顧客数（棒グラフ）
  - 年齢層別の平均購入金額（棒グラフ）
  - 年齢層別の総購入金額（積み上げ棒グラフ）

- **性別分析**
  - 性別の顧客数（円グラフ）
  - 性別の平均購入金額（棒グラフ）
  - 性別×カテゴリー別の購入傾向（ヒートマップ）

#### 2.2 顧客価値分析
- **RFM分析**
  - Recency（最終購入日からの経過日数）分布
  - Frequency（購入頻度）分布
  - Monetary（購入金額合計）分布
  - RFMスコアによる顧客セグメント分類（4象限マトリックス）

- **顧客ランキング**
  - 購入金額上位10名（テーブル）
  - 購入頻度上位10名（テーブル）
  - 顧客単価上位10名（テーブル）

#### 2.3 顧客行動分析
- **年齢と購入金額の関係**
  - 散布図（年齢 vs 購入金額、性別で色分け）
  - 年齢層別の購入金額分布（箱ひげ図）

- **顧客のカテゴリー嗜好**
  - 年齢層×カテゴリー別の購入傾向（積み上げ棒グラフ）
  - 性別×カテゴリー別の購入傾向（積み上げ棒グラフ）

---

### 3. 売上分析ページ

#### 3.1 売上概要
- **売上メトリクス（4列）**
  - 総売上高
  - 平均単価
  - 最大購入金額
  - 最小購入金額

- **売上分布**
  - 購入金額のヒストグラム（分布）
  - 購入金額の累積分布（折れ線グラフ）

#### 3.2 カテゴリー別売上分析
- **カテゴリー別売上**
  - カテゴリー別総売上（横棒グラフ）
  - カテゴリー別平均購入金額（横棒グラフ）
  - カテゴリー別購入件数（横棒グラフ）

- **カテゴリー別詳細分析**
  - カテゴリー別の購入金額分布（箱ひげ図）
  - カテゴリー×地域別の売上（ヒートマップ）
  - カテゴリー×年齢層別の売上（ヒートマップ）

#### 3.3 地域別売上分析
- **地域別売上**
  - 地域別総売上（横棒グラフ）
  - 地域別平均購入金額（横棒グラフ）
  - 地域別顧客数（横棒グラフ）

- **地域別詳細分析**
  - 地域×カテゴリー別の売上（積み上げ棒グラフ）
  - 地域×年齢層別の売上（積み上げ棒グラフ）
  - 地域別の購入金額分布（箱ひげ図）

---

### 4. 時系列分析ページ

#### 4.1 トレンド分析
- **月別トレンド**
  - 月別売上推移（折れ線グラフ、前年同月比較可能）
  - 月別購入件数推移（折れ線グラフ）
  - 月別平均購入金額推移（折れ線グラフ）

- **四半期別トレンド**
  - 四半期別売上推移（棒グラフ）
  - 四半期別成長率（折れ線グラフ）

- **年別比較**
  - 2023年 vs 2024年の月別比較（複数折れ線グラフ）
  - 年別の売上構成比（積み上げ棒グラフ）

#### 4.2 季節性分析
- **月別パターン**
  - 月別売上の平均値（棒グラフ、季節性の可視化）
  - 月別購入件数の平均値（棒グラフ）

- **曜日別分析**（購入日から曜日を抽出）
  - 曜日別売上（棒グラフ）
  - 曜日別購入件数（棒グラフ）

#### 4.3 カテゴリー別時系列
- **カテゴリー別月別推移**
  - カテゴリー別の月別売上推移（複数折れ線グラフ）
  - カテゴリー別の月別購入件数推移（複数折れ線グラフ）

---

### 5. 地域分析ページ

#### 5.1 地域別概要
- **地域別KPI（4列）**
  - 各地域の総売上
  - 各地域の平均購入金額
  - 各地域の顧客数
  - 各地域の顧客単価

#### 5.2 地域別詳細分析
- **地域×カテゴリー分析**
  - 地域×カテゴリー別の売上（ヒートマップ）
  - 地域×カテゴリー別の購入件数（ヒートマップ）

- **地域×年齢層分析**
  - 地域×年齢層別の売上（積み上げ棒グラフ）
  - 地域×年齢層別の顧客数（積み上げ棒グラフ）

- **地域×支払方法分析**
  - 地域×支払方法別の売上（積み上げ棒グラフ）
  - 地域×支払方法別のシェア（積み上げ棒グラフ）

#### 5.3 地域別比較
- **地域別の購入金額分布**
  - 箱ひげ図で地域間の分布を比較
  - バイオリンプロットで分布の形状を比較

---

### 6. カテゴリー分析ページ

#### 6.1 カテゴリー別概要
- **カテゴリー別KPI（5列）**
  - 各カテゴリーの総売上
  - 各カテゴリーの平均購入金額
  - 各カテゴリーの購入件数
  - 各カテゴリーの顧客数
  - 各カテゴリーの顧客単価

#### 6.2 カテゴリー別詳細分析
- **カテゴリー×地域分析**
  - カテゴリー×地域別の売上（ヒートマップ）
  - カテゴリー×地域別の購入件数（ヒートマップ）

- **カテゴリー×年齢層分析**
  - カテゴリー×年齢層別の売上（積み上げ棒グラフ）
  - カテゴリー×年齢層別の顧客数（積み上げ棒グラフ）

- **カテゴリー×性別分析**
  - カテゴリー×性別別の売上（積み上げ棒グラフ）
  - カテゴリー×性別別の購入件数（積み上げ棒グラフ）

#### 6.3 カテゴリー別トレンド
- **カテゴリー別月別推移**
  - 各カテゴリーの月別売上推移（複数折れ線グラフ）
  - 各カテゴリーの月別購入件数推移（複数折れ線グラフ）

---

### 7. 支払方法分析ページ

#### 7.1 支払方法別概要
- **支払方法別KPI（3列）**
  - 各支払方法の総売上
  - 各支払方法の平均購入金額
  - 各支払方法の利用件数

#### 7.2 支払方法別詳細分析
- **支払方法×カテゴリー分析**
  - 支払方法×カテゴリー別の売上（ヒートマップ）
  - 支払方法×カテゴリー別の利用件数（ヒートマップ）

- **支払方法×年齢層分析**
  - 支払方法×年齢層別の売上（積み上げ棒グラフ）
  - 支払方法×年齢層別の利用件数（積み上げ棒グラフ）

- **支払方法×地域分析**
  - 支払方法×地域別の売上（積み上げ棒グラフ）
  - 支払方法×地域別の利用シェア（積み上げ棒グラフ）

#### 7.3 支払方法別トレンド
- **支払方法別月別推移**
  - 各支払方法の月別売上推移（複数折れ線グラフ）
  - 各支払方法の月別利用シェア推移（積み上げエリアチャート）

---

### 8. セグメント分析ページ

#### 8.1 複合セグメント分析
- **地域×カテゴリー×年齢層**
  - 3次元ヒートマップ（地域×カテゴリー、年齢層で色分け）
  - サンキーダイアグラム（地域→カテゴリー→年齢層）

- **性別×地域×カテゴリー**
  - 性別×地域×カテゴリー別の売上（3次元バブルチャート）
  - 性別×地域×カテゴリー別の購入件数（3次元バブルチャート）

#### 8.2 顧客セグメントマトリックス
- **年齢層×購入金額カテゴリ**
  - 2×2または3×3のマトリックス
  - 各セグメントの顧客数と平均購入金額を表示

- **地域×カテゴリー**
  - 地域×カテゴリーのマトリックス
  - 各セルに売上と購入件数を表示

---

### 9. 相関分析ページ

#### 9.1 変数間の相関
- **相関マトリックス**
  - 数値変数（年齢、購入金額）の相関マトリックス（ヒートマップ）
  - カテゴリカル変数間の関連性（クラスターマップ）

#### 9.2 多変量分析
- **主成分分析（PCA）**
  - 主成分スコアの散布図
  - 主成分負荷量の可視化

- **クラスター分析**
  - 顧客クラスターの可視化（散布図）
  - クラスター別の特徴（棒グラフ）

---

### 10. 詳細データ探索ページ

#### 10.1 データテーブル
- **フィルタリング機能**
  - 地域、カテゴリー、性別、年齢層、支払方法でフィルタリング
  - 購入金額の範囲指定
  - 購入日の期間指定

- **ソート機能**
  - 任意のカラムでソート可能
  - 複数カラムでのソート

- **検索機能**
  - 顧客IDでの検索
  - テキスト検索

#### 10.2 データエクスポート
- **CSVダウンロード**
  - フィルター済みデータのダウンロード
  - 全データのダウンロード

- **レポート生成**
  - PDF形式でのレポート生成（オプション）
  - Excel形式でのレポート生成（オプション）

---

## サイドバー機能（全ページ共通）

### フィルター設定
- **期間フィルター**
  - 開始日・終了日の選択（日付ピッカー）
  - 期間のプリセット（今月、先月、四半期、年間など）

- **地域フィルター**
  - 複数選択可能なチェックボックス

- **カテゴリーフィルター**
  - 複数選択可能なチェックボックス

- **性別フィルター**
  - ラジオボタンまたはチェックボックス

- **年齢層フィルター**
  - スライダーまたはチェックボックス

- **支払方法フィルター**
  - 複数選択可能なチェックボックス

- **購入金額フィルター**
  - 最小値・最大値のスライダー

### 表示設定
- **グラフの種類切り替え**
  - 棒グラフ/折れ線グラフ/エリアチャートの切り替え

- **集計単位の選択**
  - 日別/週別/月別/四半期別/年別

- **データ更新ボタン**
  - フィルター適用後のデータ更新

---

## インタラクティブ機能

### グラフのインタラクション
- **ホバー表示**
  - マウスオーバーで詳細情報を表示
  - ツールチップに詳細データを表示

- **ズーム・パン**
  - Plotlyグラフでのズーム・パン機能
  - データポイントの選択

- **凡例のクリック**
  - 凡例をクリックして系列の表示/非表示を切り替え

### ドリルダウン機能
- **グラフから詳細へ**
  - グラフの要素をクリックして詳細ページへ遷移
  - 例: 地域の棒グラフをクリック→地域詳細ページへ

- **階層的なナビゲーション**
  - 概要→詳細→個別データの流れ

---

## デザイン方針

### カラーパレット
- **メインカラー**: プロフェッショナルな青系
- **アクセントカラー**: オレンジまたは緑
- **カテゴリー別色分け**: 一貫した色マッピング
  - スポーツ: 青
  - 家電: オレンジ
  - 食品: 緑
  - ファッション: ピンク
  - 書籍: 紫

### レイアウト
- **ワイドレイアウト**: 最大限の画面幅を活用
- **レスポンシブデザイン**: 画面サイズに応じた調整
- **カード形式**: 各セクションをカードで区切る

### タイポグラフィ
- **見出し**: 明確な階層構造
- **数値**: 大きなフォントで強調
- **単位**: 明確に表示（¥、件、%など）

---

## パフォーマンス最適化

### データキャッシュ
- **Streamlitキャッシュ**: `@st.cache_data`でデータ読み込みをキャッシュ
- **集計結果のキャッシュ**: フィルター適用後の集計結果をキャッシュ

### レイジーローディング
- **タブベースの読み込み**: タブを開いたときにのみデータを読み込む
- **ページネーション**: 大量データの場合はページネーションを実装

---

## 3段階実装計画

### 概要

このダッシュボードは3段階に分けて開発を進めます。各ステップで実装する機能の割合は以下の通りです：

- **ステップ1（ミニマム版）**: 50%機能 - 最小限の機能で動くダッシュボード
- **ステップ2（機能追加版）**: 80%機能 - より詳細な分析機能を追加
- **ステップ3（完全版）**: 100%機能 - すべての機能を実装した完全なダッシュボード

### 各ステップの機能比較

| 機能カテゴリー | ステップ1（50%） | ステップ2（80%） | ステップ3（100%） |
|---|---|---|---|
| **ページ数** | 2ページ | 5ページ | 10ページ |
| **KPI指標** | 4個 | 8個 | 8個（各ページで拡張） |
| **基本グラフ** | 円グラフ、棒グラフ、折れ線グラフ | 上記 + 散布図、ヒストグラム | 上記 + ヒートマップ、箱ひげ図、3次元グラフ |
| **フィルター** | 地域、カテゴリー | 上記 + 期間、性別、年齢層、購入金額、支払方法 | 上記 + プリセット、表示設定 |
| **分析機能** | 基本集計 | 上記 + 年齢層分析、時系列分析 | 上記 + RFM分析、相関分析、クラスター分析 |
| **インタラクティブ機能** | 基本 | 基本 | ドリルダウン、ズーム・パン |
| **データエクスポート** | CSV | CSV | CSV + Excel |

---

### ステップ1: ミニマム版（50%機能）🎯

**目標**: 最小限の機能で動くダッシュボードを作成し、基本的なデータ可視化を実現する

#### 実装するページ（2ページ）

##### 1. トップページ（概要ダッシュボード）
- **主要KPI指標（4列）**
  - 総顧客数
  - 総購入金額
  - 平均購入金額
  - 総購入件数

- **トレンド表示（2列）**
  - 月別売上推移（折れ線グラフ）
  - 月別購入件数推移（棒グラフ）

- **主要インサイト（3列）**
  - 地域別売上シェア（円グラフ）
  - カテゴリー別売上シェア（円グラフ）
  - 支払方法別シェア（円グラフ）

##### 2. 詳細データ探索ページ
- **データテーブル**
  - 基本的なテーブル表示
  - 基本的なソート機能（1カラムのみ）

- **CSVダウンロード**
  - フィルター済みデータのダウンロード

#### 実装するサイドバー機能（最小限）
- **地域フィルター**
  - 複数選択可能なチェックボックス（デフォルト: 全選択）

- **カテゴリーフィルター**
  - 複数選択可能なチェックボックス（デフォルト: 全選択）

#### 実装する技術要素
- Streamlitの基本機能のみ
- Plotly Express（基本的なグラフ）
- Pandas（データ処理）
- データキャッシュ（`@st.cache_data`）

#### 実装しない機能
- 時系列分析ページ
- 顧客分析ページ
- 売上分析ページ
- 高度なフィルター（期間、年齢層、支払方法など）
- インタラクティブなドリルダウン
- 複雑な可視化（ヒートマップ、箱ひげ図など）

---

### ステップ2: 機能追加版（80%機能）🚀

**目標**: ステップ1の機能に加えて、より詳細な分析と可視化を追加する

#### 追加実装するページ（3ページ）

##### 3. 時系列分析ページ（新規追加）
- **月別トレンド**
  - 月別売上推移（折れ線グラフ）
  - 月別購入件数推移（折れ線グラフ）
  - 月別平均購入金額推移（折れ線グラフ）

- **年別比較**
  - 2023年 vs 2024年の月別比較（複数折れ線グラフ）

##### 4. 顧客分析ページ（新規追加）
- **年齢層別分析**
  - 年齢層の定義（10代、20代、30代、40代、50代、60代、70代以上）
  - 年齢層別の顧客数（棒グラフ）
  - 年齢層別の平均購入金額（棒グラフ）

- **性別分析**
  - 性別の顧客数（円グラフ）
  - 性別の平均購入金額（棒グラフ）

- **年齢と購入金額の関係**
  - 散布図（年齢 vs 購入金額、性別で色分け）

##### 5. 売上分析ページ（新規追加）
- **売上概要**
  - 売上メトリクス（4列）
    - 総売上高
    - 平均単価
    - 最大購入金額
    - 最小購入金額
  - 購入金額のヒストグラム（分布）

- **カテゴリー別売上分析**
  - カテゴリー別総売上（横棒グラフ）
  - カテゴリー別平均購入金額（横棒グラフ）
  - カテゴリー別購入件数（横棒グラフ）

- **地域別売上分析**
  - 地域別総売上（横棒グラフ）
  - 地域別平均購入金額（横棒グラフ）

#### 拡張する既存ページ

##### トップページ（拡張）
- **KPI指標を8個に拡張**
  - 顧客単価を追加
  - 月間平均売上を追加
  - リピート率を追加
  - 成長率を追加

##### 詳細データ探索ページ（拡張）
- **フィルタリング機能の追加**
  - 性別フィルター
  - 年齢層フィルター（スライダー）
  - 購入金額フィルター（スライダー）
  - 期間フィルター（日付ピッカー）

- **ソート機能の拡張**
  - 複数カラムでのソート

- **検索機能**
  - 顧客IDでの検索

#### 追加実装するサイドバー機能
- **期間フィルター**
  - 開始日・終了日の選択（日付ピッカー）

- **性別フィルター**
  - チェックボックス

- **年齢層フィルター**
  - スライダー（最小値・最大値）

- **購入金額フィルター**
  - スライダー（最小値・最大値）

- **支払方法フィルター**
  - 複数選択可能なチェックボックス

#### 追加実装する技術要素
- Plotlyのより高度な機能（複数系列の折れ線グラフ）
- 日付処理（pandasの日付機能）
- より複雑なデータ集計

#### 実装しない機能
- 地域分析ページ（独立ページ）
- カテゴリー分析ページ（独立ページ）
- 支払方法分析ページ（独立ページ）
- セグメント分析ページ
- 相関分析ページ
- RFM分析の詳細実装
- クラスター分析
- ヒートマップ
- 箱ひげ図
- バイオリンプロット
- サンキーダイアグラム
- 3次元バブルチャート

---

### ステップ3: 完全版（100%機能）✨

**目標**: すべての機能を実装し、完全なダッシュボードを完成させる

#### 追加実装するページ（5ページ）

##### 6. 地域分析ページ（新規追加）
- **地域別概要**
  - 地域別KPI（4列）
    - 各地域の総売上
    - 各地域の平均購入金額
    - 各地域の顧客数
    - 各地域の顧客単価

- **地域別詳細分析**
  - 地域×カテゴリー別の売上（ヒートマップ）
  - 地域×年齢層別の売上（積み上げ棒グラフ）
  - 地域×支払方法別の売上（積み上げ棒グラフ）

- **地域別比較**
  - 地域別の購入金額分布（箱ひげ図）

##### 7. カテゴリー分析ページ（新規追加）
- **カテゴリー別概要**
  - カテゴリー別KPI（5列）
    - 各カテゴリーの総売上
    - 各カテゴリーの平均購入金額
    - 各カテゴリーの購入件数
    - 各カテゴリーの顧客数
    - 各カテゴリーの顧客単価

- **カテゴリー別詳細分析**
  - カテゴリー×地域別の売上（ヒートマップ）
  - カテゴリー×年齢層別の売上（積み上げ棒グラフ）
  - カテゴリー×性別別の売上（積み上げ棒グラフ）

- **カテゴリー別トレンド**
  - 各カテゴリーの月別売上推移（複数折れ線グラフ）

##### 8. 支払方法分析ページ（新規追加）
- **支払方法別概要**
  - 支払方法別KPI（3列）
    - 各支払方法の総売上
    - 各支払方法の平均購入金額
    - 各支払方法の利用件数

- **支払方法別詳細分析**
  - 支払方法×カテゴリー別の売上（ヒートマップ）
  - 支払方法×年齢層別の売上（積み上げ棒グラフ）
  - 支払方法×地域別の売上（積み上げ棒グラフ）

- **支払方法別トレンド**
  - 各支払方法の月別売上推移（複数折れ線グラフ）
  - 各支払方法の月別利用シェア推移（積み上げエリアチャート）

##### 9. セグメント分析ページ（新規追加）
- **複合セグメント分析**
  - 地域×カテゴリー×年齢層（3次元ヒートマップ）
  - 性別×地域×カテゴリー別の売上（3次元バブルチャート）

- **顧客セグメントマトリックス**
  - 年齢層×購入金額カテゴリのマトリックス
  - 地域×カテゴリーのマトリックス

##### 10. 相関分析ページ（新規追加）
- **変数間の相関**
  - 数値変数（年齢、購入金額）の相関マトリックス（ヒートマップ）
  - カテゴリカル変数間の関連性（クラスターマップ）

- **多変量分析**
  - 主成分分析（PCA）の可視化
  - クラスター分析の可視化

#### 拡張する既存ページ

##### 顧客分析ページ（拡張）
- **顧客価値分析**
  - RFM分析
    - Recency分布
    - Frequency分布
    - Monetary分布
    - RFMスコアによる顧客セグメント分類（4象限マトリックス）

- **顧客ランキング**
  - 購入金額上位10名（テーブル）
  - 購入頻度上位10名（テーブル）
  - 顧客単価上位10名（テーブル）

- **顧客行動分析（拡張）**
  - 年齢層別の購入金額分布（箱ひげ図）
  - 年齢層×カテゴリー別の購入傾向（積み上げ棒グラフ）
  - 性別×カテゴリー別の購入傾向（積み上げ棒グラフ）

##### 売上分析ページ（拡張）
- **売上分布（拡張）**
  - 購入金額の累積分布（折れ線グラフ）

- **カテゴリー別詳細分析（拡張）**
  - カテゴリー別の購入金額分布（箱ひげ図）
  - カテゴリー×地域別の売上（ヒートマップ）
  - カテゴリー×年齢層別の売上（ヒートマップ）

- **地域別詳細分析（拡張）**
  - 地域×カテゴリー別の売上（積み上げ棒グラフ）
  - 地域×年齢層別の売上（積み上げ棒グラフ）
  - 地域別の購入金額分布（箱ひげ図）

##### 時系列分析ページ（拡張）
- **四半期別トレンド**
  - 四半期別売上推移（棒グラフ）
  - 四半期別成長率（折れ線グラフ）

- **季節性分析**
  - 月別売上の平均値（棒グラフ、季節性の可視化）
  - 月別購入件数の平均値（棒グラフ）
  - 曜日別売上（棒グラフ）
  - 曜日別購入件数（棒グラフ）

- **カテゴリー別時系列**
  - カテゴリー別の月別売上推移（複数折れ線グラフ）
  - カテゴリー別の月別購入件数推移（複数折れ線グラフ）

##### 詳細データ探索ページ（拡張）
- **レポート生成**
  - Excel形式でのレポート生成

#### 追加実装するサイドバー機能
- **期間のプリセット**
  - 今月、先月、四半期、年間などのプリセット

- **表示設定**
  - グラフの種類切り替え（棒グラフ/折れ線グラフ/エリアチャート）
  - 集計単位の選択（日別/週別/月別/四半期別/年別）

#### 追加実装するインタラクティブ機能
- **グラフのインタラクション**
  - ホバー表示（詳細情報）
  - ズーム・パン機能
  - 凡例のクリックで系列の表示/非表示

- **ドリルダウン機能**
  - グラフの要素をクリックして詳細ページへ遷移
  - 階層的なナビゲーション（概要→詳細→個別データ）

#### 追加実装する技術要素
- Seaborn（ヒートマップ、箱ひげ図など）
- Scikit-learn（PCA、クラスター分析）
- Plotlyの高度な機能（3次元グラフ、サンキーダイアグラムなど）
- より高度なデータ処理と集計

---

## 各ステップの実装チェックリスト

### ステップ1: ミニマム版（50%機能）チェックリスト

#### ページ実装
- [ ] トップページの作成
  - [ ] KPI指標4個の表示
  - [ ] 月別売上推移グラフ
  - [ ] 月別購入件数推移グラフ
  - [ ] 地域別売上シェア（円グラフ）
  - [ ] カテゴリー別売上シェア（円グラフ）
  - [ ] 支払方法別シェア（円グラフ）
- [ ] 詳細データ探索ページの作成
  - [ ] データテーブルの表示
  - [ ] 基本的なソート機能
  - [ ] CSVダウンロード機能

#### サイドバー機能
- [ ] 地域フィルターの実装
- [ ] カテゴリーフィルターの実装
- [ ] フィルター適用ロジックの実装

#### データ処理
- [ ] CSVデータの読み込み
- [ ] 日付データの変換
- [ ] データキャッシュの実装
- [ ] 月別集計の実装

#### テスト項目
- [ ] データが正しく読み込まれるか
- [ ] フィルターが正しく動作するか
- [ ] グラフが正しく表示されるか
- [ ] CSVダウンロードが動作するか

**完了条件**: 上記すべてのチェック項目が完了し、基本的なダッシュボードが動作すること

---

### ステップ2: 機能追加版（80%機能）チェックリスト

#### 新規ページ実装
- [ ] 時系列分析ページの作成
  - [ ] 月別売上推移グラフ
  - [ ] 月別購入件数推移グラフ
  - [ ] 月別平均購入金額推移グラフ
  - [ ] 年別比較グラフ
- [ ] 顧客分析ページの作成
  - [ ] 年齢層の定義と分類
  - [ ] 年齢層別の顧客数グラフ
  - [ ] 年齢層別の平均購入金額グラフ
  - [ ] 性別の顧客数グラフ
  - [ ] 性別の平均購入金額グラフ
  - [ ] 年齢と購入金額の散布図
- [ ] 売上分析ページの作成
  - [ ] 売上メトリクス4個の表示
  - [ ] 購入金額のヒストグラム
  - [ ] カテゴリー別売上グラフ
  - [ ] カテゴリー別平均購入金額グラフ
  - [ ] カテゴリー別購入件数グラフ
  - [ ] 地域別売上グラフ
  - [ ] 地域別平均購入金額グラフ

#### 既存ページの拡張
- [ ] トップページのKPIを8個に拡張
  - [ ] 顧客単価の追加
  - [ ] 月間平均売上の追加
  - [ ] リピート率の追加
  - [ ] 成長率の追加
- [ ] 詳細データ探索ページの拡張
  - [ ] 性別フィルターの追加
  - [ ] 年齢層フィルターの追加
  - [ ] 購入金額フィルターの追加
  - [ ] 期間フィルターの追加
  - [ ] 複数カラムソートの実装
  - [ ] 顧客ID検索機能の実装

#### サイドバー機能の拡張
- [ ] 期間フィルターの実装
- [ ] 性別フィルターの実装
- [ ] 年齢層フィルターの実装
- [ ] 購入金額フィルターの実装
- [ ] 支払方法フィルターの実装

#### データ処理の拡張
- [ ] 年齢層分類ロジックの実装
- [ ] リピート率計算ロジックの実装
- [ ] 成長率計算ロジックの実装
- [ ] 複雑な集計処理の実装

#### テスト項目
- [ ] 新規ページが正しく表示されるか
- [ ] 拡張されたフィルターが正しく動作するか
- [ ] 年齢層分類が正しく動作するか
- [ ] リピート率と成長率が正しく計算されるか
- [ ] 複数フィルターの組み合わせが正しく動作するか

**完了条件**: ステップ1の機能に加えて、上記すべてのチェック項目が完了し、より詳細な分析が可能になること

---

### ステップ3: 完全版（100%機能）チェックリスト

#### 新規ページ実装
- [ ] 地域分析ページの作成
  - [ ] 地域別KPI4個の表示
  - [ ] 地域×カテゴリー別ヒートマップ
  - [ ] 地域×年齢層別積み上げ棒グラフ
  - [ ] 地域×支払方法別積み上げ棒グラフ
  - [ ] 地域別購入金額分布（箱ひげ図）
- [ ] カテゴリー分析ページの作成
  - [ ] カテゴリー別KPI5個の表示
  - [ ] カテゴリー×地域別ヒートマップ
  - [ ] カテゴリー×年齢層別積み上げ棒グラフ
  - [ ] カテゴリー×性別別積み上げ棒グラフ
  - [ ] カテゴリー別月別推移グラフ
- [ ] 支払方法分析ページの作成
  - [ ] 支払方法別KPI3個の表示
  - [ ] 支払方法×カテゴリー別ヒートマップ
  - [ ] 支払方法×年齢層別積み上げ棒グラフ
  - [ ] 支払方法×地域別積み上げ棒グラフ
  - [ ] 支払方法別月別推移グラフ
  - [ ] 支払方法別月別シェア推移（積み上げエリアチャート）
- [ ] セグメント分析ページの作成
  - [ ] 地域×カテゴリー×年齢層の3次元ヒートマップ
  - [ ] 性別×地域×カテゴリー別の3次元バブルチャート
  - [ ] 年齢層×購入金額カテゴリのマトリックス
  - [ ] 地域×カテゴリーのマトリックス
- [ ] 相関分析ページの作成
  - [ ] 数値変数の相関マトリックス（ヒートマップ）
  - [ ] カテゴリカル変数間の関連性（クラスターマップ）
  - [ ] PCA可視化
  - [ ] クラスター分析可視化

#### 既存ページの拡張
- [ ] 顧客分析ページの拡張
  - [ ] RFM分析の実装
  - [ ] 顧客ランキングテーブル3種類
  - [ ] 年齢層別購入金額分布（箱ひげ図）
  - [ ] 年齢層×カテゴリー別積み上げ棒グラフ
  - [ ] 性別×カテゴリー別積み上げ棒グラフ
- [ ] 売上分析ページの拡張
  - [ ] 購入金額の累積分布グラフ
  - [ ] カテゴリー別購入金額分布（箱ひげ図）
  - [ ] カテゴリー×地域別ヒートマップ
  - [ ] カテゴリー×年齢層別ヒートマップ
  - [ ] 地域×カテゴリー別積み上げ棒グラフ
  - [ ] 地域×年齢層別積み上げ棒グラフ
  - [ ] 地域別購入金額分布（箱ひげ図）
- [ ] 時系列分析ページの拡張
  - [ ] 四半期別売上推移グラフ
  - [ ] 四半期別成長率グラフ
  - [ ] 月別売上の平均値グラフ（季節性）
  - [ ] 月別購入件数の平均値グラフ
  - [ ] 曜日別売上グラフ
  - [ ] 曜日別購入件数グラフ
  - [ ] カテゴリー別月別推移グラフ（複数系列）
  - [ ] カテゴリー別月別購入件数推移グラフ
- [ ] 詳細データ探索ページの拡張
  - [ ] Excel形式レポート生成機能

#### サイドバー機能の拡張
- [ ] 期間プリセット機能の実装
- [ ] グラフ種類切り替え機能の実装
- [ ] 集計単位選択機能の実装

#### インタラクティブ機能の実装
- [ ] グラフのホバー表示の最適化
- [ ] ズーム・パン機能の実装
- [ ] 凡例クリックで系列表示/非表示の実装
- [ ] ドリルダウン機能の実装
- [ ] 階層的ナビゲーションの実装

#### 高度なデータ処理
- [ ] RFM分析ロジックの実装
- [ ] 相関分析ロジックの実装
- [ ] PCA分析ロジックの実装
- [ ] クラスター分析ロジックの実装
- [ ] 曜日抽出ロジックの実装
- [ ] 季節性分析ロジックの実装

#### テスト項目
- [ ] すべてのページが正しく表示されるか
- [ ] すべてのフィルターが正しく動作するか
- [ ] RFM分析が正しく計算されるか
- [ ] 相関分析が正しく計算されるか
- [ ] PCAとクラスター分析が正しく動作するか
- [ ] インタラクティブ機能が正しく動作するか
- [ ] ドリルダウン機能が正しく動作するか
- [ ] パフォーマンスが許容範囲内か

**完了条件**: すべてのチェック項目が完了し、完全なダッシュボードが完成すること

---

## 実装のポイントと注意事項

### ステップ1の実装ポイント
1. **シンプルさを重視**: 必要最小限の機能に絞り、動作確認を容易にする
2. **データ読み込みの最適化**: `@st.cache_data`を必ず使用する
3. **エラーハンドリング**: データファイルが見つからない場合の処理を実装
4. **フィルターのデフォルト値**: 全選択をデフォルトにして、初期表示で全データが見えるようにする

### ステップ2の実装ポイント
1. **段階的な機能追加**: ステップ1のコードを壊さないように注意
2. **年齢層分類の一貫性**: 年齢層の定義を統一し、全ページで同じ定義を使用
3. **日付処理の正確性**: 購入日の処理でタイムゾーンやフォーマットに注意
4. **パフォーマンス**: フィルターが増えるため、集計処理の最適化を検討

### ステップ3の実装ポイント
1. **コードの整理**: 機能が増えるため、関数やクラスでコードを整理
2. **可視化の一貫性**: 同じ種類のグラフは同じスタイルを使用
3. **高度な分析の検証**: RFM分析やクラスター分析の結果が妥当か確認
4. **ユーザビリティ**: 複雑な機能でも使いやすさを重視
5. **ドキュメント**: 各機能の使い方をコメントやREADMEで説明

---

## 実装優先順位（旧版 - 参考用）

### Phase 1: 基本機能（必須）
1. トップページ（概要ダッシュボード）
2. 顧客分析ページ（基本セグメント）
3. 売上分析ページ（カテゴリー・地域別）
4. 時系列分析ページ（月別トレンド）
5. 詳細データ探索ページ（テーブル・フィルター）

### Phase 2: 詳細分析（推奨）
6. 地域分析ページ
7. カテゴリー分析ページ
8. 支払方法分析ページ
9. セグメント分析ページ（複合セグメント）

### Phase 3: 高度な分析（オプション）
10. 相関分析ページ
11. RFM分析の詳細実装
12. クラスター分析
13. 予測分析（トレンド予測など）

---

## 技術スタック

### 必須ライブラリ
- **Streamlit**: ダッシュボードフレームワーク
- **Pandas**: データ処理
- **Plotly**: インタラクティブな可視化
- **Matplotlib/Seaborn**: 静的グラフ（必要に応じて）

### オプションライブラリ
- **Scikit-learn**: クラスター分析、PCA
- **NumPy**: 数値計算
- **Dateutil**: 日付処理

---

## 注意事項

1. **データの整合性**: 購入日の範囲、年齢の妥当性などをチェック
2. **パフォーマンス**: 300件のデータなので高速に動作するはずだが、将来的な拡張を考慮
3. **ユーザビリティ**: 直感的な操作、明確なラベル、適切なデフォルト値
4. **アクセシビリティ**: 色だけでなく形状でも情報を伝える
5. **モバイル対応**: 可能な限りモバイルでも見やすいデザイン

---

## 今後の拡張案

1. **予測機能**: 売上予測、需要予測
2. **アラート機能**: 異常値の検知と通知
3. **比較機能**: 期間比較、前年同月比較の自動化
4. **レポート自動生成**: 定期レポートの自動生成
5. **データ更新機能**: 新しいデータのアップロード機能
6. **ユーザー権限管理**: 複数ユーザーでの利用を想定
7. **多言語対応**: 英語版の追加

