# 経費管理データ ダッシュボード設計書

## データ概要
- **データ期間**: 2024年5月〜2025年8月（約16ヶ月）
- **レコード数**: 約60件の経費記録
- **主要カラム**: 
  - Date（日付）
  - Vendor（ベンダー/支払先）
  - Description（説明）
  - EXP（支出金額）
  - E&E Date（支払期限日）
  - Faculty（教員関連）
  - Official（公式関連）
  - カテゴリ列: Travel, Per Diem, Bks/Jrnls/AV, EQUIP, Other, Commun., Supplies/Misc, Short-term consultants

---

## ダッシュボード全体構成

### 1. トップページ（概要ダッシュボード）

#### 1.1 主要KPI指標（4列表示）
- **総支出額**: 全期間の合計支出金額
- **平均月間支出**: 月間平均支出金額
- **総取引件数**: 全経費記録件数
- **平均取引額**: 1件あたりの平均支出金額
- **最大支出額**: 単一取引の最大金額
- **最小支出額**: 単一取引の最小金額
- **支出カテゴリ数**: 使用されたカテゴリの種類数
- **ベンダー数**: 取引先ベンダーの数

#### 1.2 トレンド表示（2列）
- **左**: 月別支出推移（折れ線グラフ）
  - 月別の総支出額を時系列で表示
  - 前月比の増減を色分けで表示
- **右**: 月別取引件数推移（棒グラフ）
  - 月別の取引件数を表示

#### 1.3 主要インサイト（3列）
- **左**: カテゴリ別支出シェア（ドーナツチャート）
  - Travel, Per Diem, Bks/Jrnls/AV, EQUIP, Other, Commun., Supplies/Misc, Short-term consultants
- **中央**: トップベンダー別支出（横棒グラフ）
  - 支出額上位5〜10社を表示
- **右**: 月別支出比較（棒グラフ）
  - 月別の支出額を比較表示

---

### 2. 時系列分析ページ

#### 2.1 トレンド分析
- **月別トレンド**
  - 月別総支出推移（折れ線グラフ、前月比表示）
  - 月別平均取引額推移（折れ線グラフ）
  - 月別取引件数推移（折れ線グラフ）
  - 累積支出推移（エリアチャート）

- **四半期別トレンド**
  - 四半期別総支出（棒グラフ）
  - 四半期別成長率（折れ線グラフ）
  - 四半期別平均月間支出（棒グラフ）

- **年別比較**
  - 2024年 vs 2025年の月別比較（複数折れ線グラフ）
  - 年別の支出構成比（積み上げ棒グラフ）

#### 2.2 季節性分析
- **月別パターン**
  - 月別支出の平均値（棒グラフ、季節性の可視化）
  - 月別取引件数の平均値（棒グラフ）
  - 月別支出の分布（箱ひげ図）

- **曜日別分析**（日付から曜日を抽出）
  - 曜日別支出（棒グラフ）
  - 曜日別取引件数（棒グラフ）

#### 2.3 カテゴリ別時系列
- **カテゴリ別月別推移**
  - カテゴリ別の月別支出推移（複数折れ線グラフ）
  - カテゴリ別の月別取引件数推移（複数折れ線グラフ）
  - カテゴリ別の累積支出推移（積み上げエリアチャート）

---

### 3. カテゴリ分析ページ

#### 3.1 カテゴリ別概要
- **カテゴリ別KPI（8列）**
  - 各カテゴリの総支出額
  - 各カテゴリの平均取引額
  - 各カテゴリの取引件数
  - 各カテゴリの支出シェア（%）
  - 各カテゴリの最大取引額
  - 各カテゴリの最小取引額
  - 各カテゴリの月間平均支出
  - 各カテゴリの使用月数

#### 3.2 カテゴリ別詳細分析
- **カテゴリ別支出比較**
  - カテゴリ別総支出（横棒グラフ）
  - カテゴリ別平均取引額（横棒グラフ）
  - カテゴリ別取引件数（横棒グラフ）
  - カテゴリ別支出シェア（円グラフ）

- **カテゴリ別詳細分析**
  - カテゴリ別の支出分布（箱ひげ図）
  - カテゴリ×月別の支出（ヒートマップ）
  - カテゴリ別の累積支出推移（複数折れ線グラフ）

#### 3.3 カテゴリ別トレンド
- **カテゴリ別月別推移**
  - 各カテゴリの月別支出推移（複数折れ線グラフ）
  - 各カテゴリの月別取引件数推移（複数折れ線グラフ）
  - カテゴリ別の支出構成比推移（積み上げエリアチャート）

---

### 4. ベンダー分析ページ

#### 4.1 ベンダー別概要
- **ベンダー別KPI（5列）**
  - 各ベンダーの総支出額
  - 各ベンダーの平均取引額
  - 各ベンダーの取引件数
  - 各ベンダーの支出シェア（%）
  - 各ベンダーの最終取引日

#### 4.2 ベンダー別詳細分析
- **トップベンダー分析**
  - 支出額上位10ベンダー（横棒グラフ）
  - 取引件数上位10ベンダー（横棒グラフ）
  - ベンダー別の支出分布（箱ひげ図）

- **ベンダー×カテゴリ分析**
  - ベンダー×カテゴリ別の支出（ヒートマップ）
  - ベンダー×カテゴリ別の取引件数（ヒートマップ）
  - 主要ベンダーのカテゴリ内訳（積み上げ棒グラフ）

#### 4.3 ベンダー別トレンド
- **ベンダー別月別推移**
  - 主要ベンダーの月別支出推移（複数折れ線グラフ）
  - ベンダー別の取引頻度推移（折れ線グラフ）

---

### 5. 支出分析ページ

#### 5.1 支出概要
- **支出メトリクス（4列）**
  - 総支出高
  - 平均取引額
  - 最大取引額
  - 最小取引額
  - 中央値取引額
  - 標準偏差

- **支出分布**
  - 取引金額のヒストグラム（分布）
  - 取引金額の累積分布（折れ線グラフ）
  - 取引金額の箱ひげ図

#### 5.2 金額帯別分析
- **金額帯別集計**
  - 金額帯別の取引件数（棒グラフ）
    - 0-500, 500-1,000, 1,000-5,000, 5,000-10,000, 10,000-50,000, 50,000以上
  - 金額帯別の総支出額（棒グラフ）
  - 金額帯別の平均取引額（棒グラフ）

- **高額取引分析**
  - 高額取引トップ10（テーブル）
  - 高額取引のカテゴリ内訳（円グラフ）
  - 高額取引のベンダー内訳（円グラフ）

#### 5.3 支出パターン分析
- **支出の集中度分析**
  - パレート分析（上位20%の取引が占める支出割合）
  - ローレンツ曲線（支出の集中度を可視化）

---

### 6. 月別比較分析ページ

#### 6.1 月別概要
- **月別KPI（4列）**
  - 各月の総支出
  - 各月の平均取引額
  - 各月の取引件数
  - 各月の前月比（%）

#### 6.2 月別詳細分析
- **月別支出比較**
  - 月別総支出（棒グラフ、前月比を色分け）
  - 月別平均取引額（棒グラフ）
  - 月別取引件数（棒グラフ）
  - 月別のカテゴリ構成比（積み上げ棒グラフ）

- **月別パターン分析**
  - 月別の支出分布（箱ひげ図）
  - 月別のカテゴリ別支出（ヒートマップ）
  - 月別のベンダー別支出（ヒートマップ）

#### 6.3 月別比較
- **前月比分析**
  - 月別の前月比推移（折れ線グラフ）
  - 前月比の分布（ヒストグラム）

- **年間比較**
  - 2024年と2025年の月別比較（複数折れ線グラフ）
  - 同じ月の年次比較（棒グラフ）

---

### 7. カテゴリ×ベンダー分析ページ

#### 7.1 カテゴリ×ベンダーマトリックス
- **ヒートマップ分析**
  - カテゴリ×ベンダー別の総支出（ヒートマップ）
  - カテゴリ×ベンダー別の取引件数（ヒートマップ）
  - カテゴリ×ベンダー別の平均取引額（ヒートマップ）

#### 7.2 主要カテゴリのベンダー分析
- **Travelカテゴリ**
  - Travelカテゴリのベンダー別支出（横棒グラフ）
  - Travelカテゴリのベンダー別取引件数（横棒グラフ）

- **Bks/Jrnls/AVカテゴリ**
  - Bks/Jrnls/AVカテゴリのベンダー別支出（横棒グラフ）
  - Bks/Jrnls/AVカテゴリのベンダー別取引件数（横棒グラフ）

- **その他主要カテゴリ**
  - 各カテゴリのベンダー内訳を個別に表示

#### 7.3 主要ベンダーのカテゴリ分析
- **Diamond Head Travel**
  - カテゴリ別支出（横棒グラフ）
  - カテゴリ別取引件数（横棒グラフ）

- **AT&T Corp**
  - カテゴリ別支出（横棒グラフ）
  - カテゴリ別取引件数（横棒グラフ）

- **その他主要ベンダー**
  - 各ベンダーのカテゴリ内訳を個別に表示

---

### 8. 詳細データ探索ページ

#### 8.1 データテーブル
- **フィルタリング機能**
  - カテゴリでフィルタリング（複数選択可能）
  - ベンダーでフィルタリング（複数選択可能）
  - 支出金額の範囲指定（スライダー）
  - 日付の期間指定（日付ピッカー）
  - 説明文での検索（テキスト検索）

- **ソート機能**
  - 任意のカラムでソート可能
  - 複数カラムでのソート
  - 昇順/降順の切り替え

- **検索機能**
  - ベンダー名での検索
  - 説明文での検索
  - 金額範囲での検索

#### 8.2 データエクスポート
- **CSVダウンロード**
  - フィルター済みデータのダウンロード
  - 全データのダウンロード

- **レポート生成**
  - PDF形式でのレポート生成（オプション）
  - Excel形式でのレポート生成（オプション）

---

## サイドバー機能（全ページ共通）

### フィルター設定
- **期間フィルター**
  - 開始日・終了日の選択（日付ピッカー）
  - 期間のプリセット（今月、先月、四半期、年間など）

- **カテゴリフィルター**
  - 複数選択可能なチェックボックス
  - 全選択/全解除ボタン

- **ベンダーフィルター**
  - 複数選択可能なチェックボックス
  - 全選択/全解除ボタン
  - 検索機能付き

- **支出金額フィルター**
  - 最小値・最大値のスライダー
  - 金額帯のプリセット選択

### 表示設定
- **グラフの種類切り替え**
  - 棒グラフ/折れ線グラフ/エリアチャートの切り替え

- **集計単位の選択**
  - 日別/週別/月別/四半期別/年別

- **データ更新ボタン**
  - フィルター適用後のデータ更新

---

## インタラクティブ機能

### グラフのインタラクション
- **ホバー表示**
  - マウスオーバーで詳細情報を表示
  - ツールチップに詳細データを表示（金額、件数、日付など）

- **ズーム・パン**
  - Plotlyグラフでのズーム・パン機能
  - データポイントの選択

- **凡例のクリック**
  - 凡例をクリックして系列の表示/非表示を切り替え

### ドリルダウン機能
- **グラフから詳細へ**
  - グラフの要素をクリックして詳細ページへ遷移
  - 例: カテゴリの棒グラフをクリック→カテゴリ詳細ページへ
  - 例: ベンダーの棒グラフをクリック→ベンダー詳細ページへ

- **階層的なナビゲーション**
  - 概要→詳細→個別データの流れ

---

## デザイン方針

### カラーパレット
- **メインカラー**: プロフェッショナルな青系
- **アクセントカラー**: オレンジまたは緑
- **カテゴリ別色分け**: 一貫した色マッピング
  - Travel: 青
  - Per Diem: オレンジ
  - Bks/Jrnls/AV: 緑
  - EQUIP: 紫
  - Other: グレー
  - Commun.: ピンク
  - Supplies/Misc: 茶色
  - Short-term consultants: 黄色

### レイアウト
- **ワイドレイアウト**: 最大限の画面幅を活用
- **レスポンシブデザイン**: 画面サイズに応じた調整
- **カード形式**: 各セクションをカードで区切る

### タイポグラフィ
- **見出し**: 明確な階層構造
- **数値**: 大きなフォントで強調
- **単位**: 明確に表示（$、件、%など）

---

## パフォーマンス最適化

### データキャッシュ
- **Streamlitキャッシュ**: `@st.cache_data`でデータ読み込みをキャッシュ
- **集計結果のキャッシュ**: フィルター適用後の集計結果をキャッシュ

### レイジーローディング
- **タブベースの読み込み**: タブを開いたときにのみデータを読み込む
- **ページネーション**: 大量データの場合はページネーションを実装

---

## 3段階実装計画

### 概要

このダッシュボードは3段階に分けて開発を進めます。各ステップで実装する機能の割合は以下の通りです：

- **ステップ1（ミニマム版）**: 50%機能 - 最小限の機能で動くダッシュボード
- **ステップ2（機能追加版）**: 80%機能 - より詳細な分析機能を追加
- **ステップ3（完全版）**: 100%機能 - すべての機能を実装した完全なダッシュボード

### 各ステップの機能比較

| 機能カテゴリー | ステップ1（50%） | ステップ2（80%） | ステップ3（100%） |
|---|---|---|---|
| **ページ数** | 2ページ | 5ページ | 8ページ |
| **KPI指標** | 4個 | 8個 | 8個（各ページで拡張） |
| **基本グラフ** | 円グラフ、棒グラフ、折れ線グラフ | 上記 + 散布図、ヒストグラム | 上記 + ヒートマップ、箱ひげ図、エリアチャート |
| **フィルター** | カテゴリ、ベンダー | 上記 + 期間、支出金額 | 上記 + プリセット、表示設定 |
| **分析機能** | 基本集計 | 上記 + 時系列分析、カテゴリ分析 | 上記 + ベンダー分析、マトリックス分析 |
| **インタラクティブ機能** | 基本 | 基本 | ドリルダウン、ズーム・パン |
| **データエクスポート** | CSV | CSV | CSV + Excel |

---

### ステップ1: ミニマム版（50%機能）🎯

**目標**: 最小限の機能で動くダッシュボードを作成し、基本的なデータ可視化を実現する

#### 実装するページ（2ページ）

##### 1. トップページ（概要ダッシュボード）
- **主要KPI指標（4列）**
  - 総支出額
  - 平均月間支出
  - 総取引件数
  - 平均取引額

- **トレンド表示（2列）**
  - 月別支出推移（折れ線グラフ）
  - 月別取引件数推移（棒グラフ）

- **主要インサイト（3列）**
  - カテゴリ別支出シェア（円グラフ）
  - トップベンダー別支出（横棒グラフ）
  - 月別支出比較（棒グラフ）

##### 2. 詳細データ探索ページ
- **データテーブル**
  - 基本的なテーブル表示
  - 基本的なソート機能（1カラムのみ）

- **CSVダウンロード**
  - フィルター済みデータのダウンロード

#### 実装するサイドバー機能（最小限）
- **カテゴリフィルター**
  - 複数選択可能なチェックボックス（デフォルト: 全選択）

- **ベンダーフィルター**
  - 複数選択可能なチェックボックス（デフォルト: 全選択）

#### 実装する技術要素
- Streamlitの基本機能のみ
- Plotly Express（基本的なグラフ）
- Pandas（データ処理）
- データキャッシュ（`@st.cache_data`）

#### 実装しない機能
- 時系列分析ページ
- カテゴリ分析ページ
- ベンダー分析ページ
- 高度なフィルター（期間、支出金額など）
- インタラクティブなドリルダウン
- 複雑な可視化（ヒートマップ、箱ひげ図など）

---

### ステップ2: 機能追加版（80%機能）🚀

**目標**: ステップ1の機能に加えて、より詳細な分析と可視化を追加する

#### 追加実装するページ（3ページ）

##### 3. 時系列分析ページ（新規追加）
- **月別トレンド**
  - 月別総支出推移（折れ線グラフ）
  - 月別平均取引額推移（折れ線グラフ）
  - 月別取引件数推移（折れ線グラフ）
  - 累積支出推移（エリアチャート）

- **年別比較**
  - 2024年 vs 2025年の月別比較（複数折れ線グラフ）

##### 4. カテゴリ分析ページ（新規追加）
- **カテゴリ別概要**
  - カテゴリ別KPI（8列）
    - 各カテゴリの総支出額
    - 各カテゴリの平均取引額
    - 各カテゴリの取引件数
    - 各カテゴリの支出シェア（%）

- **カテゴリ別詳細分析**
  - カテゴリ別総支出（横棒グラフ）
  - カテゴリ別平均取引額（横棒グラフ）
  - カテゴリ別取引件数（横棒グラフ）
  - カテゴリ別の月別支出推移（複数折れ線グラフ）

##### 5. ベンダー分析ページ（新規追加）
- **ベンダー別概要**
  - ベンダー別KPI（5列）
    - 各ベンダーの総支出額
    - 各ベンダーの平均取引額
    - 各ベンダーの取引件数
    - 各ベンダーの支出シェア（%）

- **トップベンダー分析**
  - 支出額上位10ベンダー（横棒グラフ）
  - 取引件数上位10ベンダー（横棒グラフ）
  - 主要ベンダーの月別支出推移（複数折れ線グラフ）

#### 拡張する既存ページ

##### トップページ（拡張）
- **KPI指標を8個に拡張**
  - 最大支出額を追加
  - 最小支出額を追加
  - 支出カテゴリ数を追加
  - ベンダー数を追加

##### 詳細データ探索ページ（拡張）
- **フィルタリング機能の追加**
  - 支出金額フィルター（スライダー）
  - 期間フィルター（日付ピッカー）

- **ソート機能の拡張**
  - 複数カラムでのソート

- **検索機能**
  - ベンダー名での検索
  - 説明文での検索

#### 追加実装するサイドバー機能
- **期間フィルター**
  - 開始日・終了日の選択（日付ピッカー）

- **支出金額フィルター**
  - スライダー（最小値・最大値）

#### 追加実装する技術要素
- Plotlyのより高度な機能（複数系列の折れ線グラフ、エリアチャート）
- 日付処理（pandasの日付機能）
- より複雑なデータ集計

#### 実装しない機能
- 支出分析ページ（独立ページ）
- 月別比較分析ページ（独立ページ）
- カテゴリ×ベンダー分析ページ
- ヒートマップ
- 箱ひげ図
- パレート分析
- ローレンツ曲線

---

### ステップ3: 完全版（100%機能）✨

**目標**: すべての機能を実装し、完全なダッシュボードを完成させる

#### 追加実装するページ（3ページ）

##### 6. 支出分析ページ（新規追加）
- **支出概要**
  - 支出メトリクス（6列）
    - 総支出高、平均取引額、最大取引額、最小取引額、中央値取引額、標準偏差
  - 取引金額のヒストグラム（分布）
  - 取引金額の累積分布（折れ線グラフ）

- **金額帯別分析**
  - 金額帯別の取引件数（棒グラフ）
  - 金額帯別の総支出額（棒グラフ）
  - 高額取引トップ10（テーブル）

- **支出パターン分析**
  - パレート分析（上位20%の取引が占める支出割合）
  - ローレンツ曲線（支出の集中度を可視化）

##### 7. 月別比較分析ページ（新規追加）
- **月別概要**
  - 月別KPI（4列）
    - 各月の総支出、平均取引額、取引件数、前月比（%）

- **月別詳細分析**
  - 月別総支出（棒グラフ、前月比を色分け）
  - 月別のカテゴリ構成比（積み上げ棒グラフ）
  - 月別のカテゴリ別支出（ヒートマップ）

- **月別比較**
  - 月別の前月比推移（折れ線グラフ）
  - 2024年と2025年の月別比較（複数折れ線グラフ）

##### 8. カテゴリ×ベンダー分析ページ（新規追加）
- **カテゴリ×ベンダーマトリックス**
  - カテゴリ×ベンダー別の総支出（ヒートマップ）
  - カテゴリ×ベンダー別の取引件数（ヒートマップ）

- **主要カテゴリのベンダー分析**
  - Travelカテゴリのベンダー別支出（横棒グラフ）
  - Bks/Jrnls/AVカテゴリのベンダー別支出（横棒グラフ）

- **主要ベンダーのカテゴリ分析**
  - Diamond Head Travelのカテゴリ別支出（横棒グラフ）
  - AT&T Corpのカテゴリ別支出（横棒グラフ）

#### 拡張する既存ページ

##### 時系列分析ページ（拡張）
- **四半期別トレンド**
  - 四半期別総支出（棒グラフ）
  - 四半期別成長率（折れ線グラフ）

- **季節性分析**
  - 月別支出の平均値（棒グラフ、季節性の可視化）
  - 曜日別支出（棒グラフ）

- **カテゴリ別時系列**
  - カテゴリ別の月別支出推移（複数折れ線グラフ）
  - カテゴリ別の累積支出推移（積み上げエリアチャート）

##### カテゴリ分析ページ（拡張）
- **カテゴリ別詳細分析（拡張）**
  - カテゴリ別の支出分布（箱ひげ図）
  - カテゴリ×月別の支出（ヒートマップ）

##### ベンダー分析ページ（拡張）
- **ベンダー×カテゴリ分析**
  - ベンダー×カテゴリ別の支出（ヒートマップ）
  - 主要ベンダーのカテゴリ内訳（積み上げ棒グラフ）

##### 詳細データ探索ページ（拡張）
- **レポート生成**
  - Excel形式でのレポート生成

#### 追加実装するサイドバー機能
- **期間のプリセット**
  - 今月、先月、四半期、年間などのプリセット

- **表示設定**
  - グラフの種類切り替え（棒グラフ/折れ線グラフ/エリアチャート）
  - 集計単位の選択（日別/週別/月別/四半期別/年別）

#### 追加実装するインタラクティブ機能
- **グラフのインタラクション**
  - ホバー表示（詳細情報）
  - ズーム・パン機能
  - 凡例のクリックで系列の表示/非表示

- **ドリルダウン機能**
  - グラフの要素をクリックして詳細ページへ遷移
  - 階層的なナビゲーション（概要→詳細→個別データ）

#### 追加実装する技術要素
- Seaborn（ヒートマップ、箱ひげ図など）
- Plotlyの高度な機能（エリアチャート、ヒートマップなど）
- より高度なデータ処理と集計

---

## 各ステップの実装チェックリスト

### ステップ1: ミニマム版（50%機能）チェックリスト

#### ページ実装
- [ ] トップページの作成
  - [ ] KPI指標4個の表示
  - [ ] 月別支出推移グラフ
  - [ ] 月別取引件数推移グラフ
  - [ ] カテゴリ別支出シェア（円グラフ）
  - [ ] トップベンダー別支出（横棒グラフ）
  - [ ] 月別支出比較（棒グラフ）
- [ ] 詳細データ探索ページの作成
  - [ ] データテーブルの表示
  - [ ] 基本的なソート機能
  - [ ] CSVダウンロード機能

#### サイドバー機能
- [ ] カテゴリフィルターの実装
- [ ] ベンダーフィルターの実装
- [ ] フィルター適用ロジックの実装

#### データ処理
- [ ] CSVデータの読み込み
- [ ] 日付データの変換
- [ ] データキャッシュの実装
- [ ] 月別集計の実装
- [ ] カテゴリ別集計の実装
- [ ] ベンダー別集計の実装

#### テスト項目
- [ ] データが正しく読み込まれるか
- [ ] フィルターが正しく動作するか
- [ ] グラフが正しく表示されるか
- [ ] CSVダウンロードが動作するか

**完了条件**: 上記すべてのチェック項目が完了し、基本的なダッシュボードが動作すること

---

### ステップ2: 機能追加版（80%機能）チェックリスト

#### 新規ページ実装
- [ ] 時系列分析ページの作成
  - [ ] 月別総支出推移グラフ
  - [ ] 月別平均取引額推移グラフ
  - [ ] 月別取引件数推移グラフ
  - [ ] 累積支出推移（エリアチャート）
  - [ ] 年別比較グラフ
- [ ] カテゴリ分析ページの作成
  - [ ] カテゴリ別KPI8個の表示
  - [ ] カテゴリ別総支出グラフ
  - [ ] カテゴリ別平均取引額グラフ
  - [ ] カテゴリ別取引件数グラフ
  - [ ] カテゴリ別の月別支出推移グラフ
- [ ] ベンダー分析ページの作成
  - [ ] ベンダー別KPI5個の表示
  - [ ] 支出額上位10ベンダーグラフ
  - [ ] 取引件数上位10ベンダーグラフ
  - [ ] 主要ベンダーの月別支出推移グラフ

#### 既存ページの拡張
- [ ] トップページのKPIを8個に拡張
  - [ ] 最大支出額の追加
  - [ ] 最小支出額の追加
  - [ ] 支出カテゴリ数の追加
  - [ ] ベンダー数の追加
- [ ] 詳細データ探索ページの拡張
  - [ ] 支出金額フィルターの追加
  - [ ] 期間フィルターの追加
  - [ ] 複数カラムソートの実装
  - [ ] ベンダー名検索機能の実装
  - [ ] 説明文検索機能の実装

#### サイドバー機能の拡張
- [ ] 期間フィルターの実装
- [ ] 支出金額フィルターの実装

#### データ処理の拡張
- [ ] 累積支出計算ロジックの実装
- [ ] 前月比計算ロジックの実装
- [ ] 複雑な集計処理の実装

#### テスト項目
- [ ] 新規ページが正しく表示されるか
- [ ] 拡張されたフィルターが正しく動作するか
- [ ] 累積支出が正しく計算されるか
- [ ] 複数フィルターの組み合わせが正しく動作するか

**完了条件**: ステップ1の機能に加えて、上記すべてのチェック項目が完了し、より詳細な分析が可能になること

---

### ステップ3: 完全版（100%機能）チェックリスト

#### 新規ページ実装
- [ ] 支出分析ページの作成
  - [ ] 支出メトリクス6個の表示
  - [ ] 取引金額のヒストグラム
  - [ ] 取引金額の累積分布グラフ
  - [ ] 金額帯別の取引件数グラフ
  - [ ] 金額帯別の総支出額グラフ
  - [ ] 高額取引トップ10テーブル
  - [ ] パレート分析の実装
  - [ ] ローレンツ曲線の実装
- [ ] 月別比較分析ページの作成
  - [ ] 月別KPI4個の表示
  - [ ] 月別総支出グラフ（前月比色分け）
  - [ ] 月別のカテゴリ構成比グラフ
  - [ ] 月別のカテゴリ別支出ヒートマップ
  - [ ] 月別の前月比推移グラフ
  - [ ] 年別比較グラフ
- [ ] カテゴリ×ベンダー分析ページの作成
  - [ ] カテゴリ×ベンダー別の総支出ヒートマップ
  - [ ] カテゴリ×ベンダー別の取引件数ヒートマップ
  - [ ] Travelカテゴリのベンダー別支出グラフ
  - [ ] Bks/Jrnls/AVカテゴリのベンダー別支出グラフ
  - [ ] Diamond Head Travelのカテゴリ別支出グラフ
  - [ ] AT&T Corpのカテゴリ別支出グラフ

#### 既存ページの拡張
- [ ] 時系列分析ページの拡張
  - [ ] 四半期別総支出グラフ
  - [ ] 四半期別成長率グラフ
  - [ ] 月別支出の平均値グラフ（季節性）
  - [ ] 曜日別支出グラフ
  - [ ] カテゴリ別の月別支出推移グラフ（複数系列）
  - [ ] カテゴリ別の累積支出推移グラフ（積み上げエリア）
- [ ] カテゴリ分析ページの拡張
  - [ ] カテゴリ別の支出分布（箱ひげ図）
  - [ ] カテゴリ×月別の支出ヒートマップ
- [ ] ベンダー分析ページの拡張
  - [ ] ベンダー×カテゴリ別の支出ヒートマップ
  - [ ] 主要ベンダーのカテゴリ内訳グラフ
- [ ] 詳細データ探索ページの拡張
  - [ ] Excel形式レポート生成機能

#### サイドバー機能の拡張
- [ ] 期間プリセット機能の実装
- [ ] グラフ種類切り替え機能の実装
- [ ] 集計単位選択機能の実装

#### インタラクティブ機能の実装
- [ ] グラフのホバー表示の最適化
- [ ] ズーム・パン機能の実装
- [ ] 凡例クリックで系列表示/非表示の実装
- [ ] ドリルダウン機能の実装
- [ ] 階層的ナビゲーションの実装

#### 高度なデータ処理
- [ ] パレート分析ロジックの実装
- [ ] ローレンツ曲線計算ロジックの実装
- [ ] 曜日抽出ロジックの実装
- [ ] 季節性分析ロジックの実装
- [ ] ヒートマップ生成ロジックの実装

#### テスト項目
- [ ] すべてのページが正しく表示されるか
- [ ] すべてのフィルターが正しく動作するか
- [ ] パレート分析が正しく計算されるか
- [ ] ヒートマップが正しく表示されるか
- [ ] インタラクティブ機能が正しく動作するか
- [ ] ドリルダウン機能が正しく動作するか
- [ ] パフォーマンスが許容範囲内か

**完了条件**: すべてのチェック項目が完了し、完全なダッシュボードが完成すること

---

## 実装のポイントと注意事項

### ステップ1の実装ポイント
1. **シンプルさを重視**: 必要最小限の機能に絞り、動作確認を容易にする
2. **データ読み込みの最適化**: `@st.cache_data`を必ず使用する
3. **エラーハンドリング**: データファイルが見つからない場合の処理を実装
4. **フィルターのデフォルト値**: 全選択をデフォルトにして、初期表示で全データが見えるようにする
5. **CSVデータの前処理**: 空行や合計行を適切に処理する

### ステップ2の実装ポイント
1. **段階的な機能追加**: ステップ1のコードを壊さないように注意
2. **日付処理の正確性**: 日付の処理でタイムゾーンやフォーマットに注意
3. **パフォーマンス**: フィルターが増えるため、集計処理の最適化を検討
4. **累積計算の効率化**: 累積支出の計算を効率的に実装

### ステップ3の実装ポイント
1. **コードの整理**: 機能が増えるため、関数やクラスでコードを整理
2. **可視化の一貫性**: 同じ種類のグラフは同じスタイルを使用
3. **高度な分析の検証**: パレート分析やローレンツ曲線の結果が妥当か確認
4. **ユーザビリティ**: 複雑な機能でも使いやすさを重視
5. **ドキュメント**: 各機能の使い方をコメントやREADMEで説明

---

## 技術スタック

### 必須ライブラリ
- **Streamlit**: ダッシュボードフレームワーク
- **Pandas**: データ処理
- **Plotly**: インタラクティブな可視化
- **NumPy**: 数値計算

### オプションライブラリ
- **Seaborn**: ヒートマップ、箱ひげ図など
- **Matplotlib**: 静的グラフ（必要に応じて）
- **OpenPyXL**: Excel形式のエクスポート

---

## 注意事項

1. **データの整合性**: 日付の範囲、金額の妥当性などをチェック
2. **パフォーマンス**: 約60件のデータなので高速に動作するはずだが、将来的な拡張を考慮
3. **ユーザビリティ**: 直感的な操作、明確なラベル、適切なデフォルト値
4. **アクセシビリティ**: 色だけでなく形状でも情報を伝える
5. **モバイル対応**: 可能な限りモバイルでも見やすいデザイン
6. **CSVデータの前処理**: 空行、合計行、ヘッダー行の処理に注意

---

## 今後の拡張案

1. **予測機能**: 支出予測、予算予測
2. **アラート機能**: 異常値の検知と通知、予算超過の警告
3. **比較機能**: 期間比較、前年同月比較の自動化
4. **レポート自動生成**: 定期レポートの自動生成
5. **データ更新機能**: 新しいデータのアップロード機能
6. **予算管理機能**: 予算設定と実績との比較
7. **承認ワークフロー**: 経費承認プロセスの可視化
8. **多言語対応**: 英語版の追加

