# FR 経費管理データ ダッシュボード

## プロジェクト概要

FR/Logistic.csvの経費管理データを可視化するStreamlitダッシュボードです。

## 環境設定

### venv環境の有効化

既存の`python/streamlit`ディレクトリのvenv環境を使用します。

#### Windows PowerShellの場合:
```powershell
cd python/streamlit
.\venv\Scripts\Activate.ps1
```

#### Windows CMDの場合:
```cmd
cd python\streamlit
venv\Scripts\activate.bat
```

### 必要なライブラリ

以下のライブラリが既にインストールされています：
- streamlit (1.51.0)
- pandas (2.3.3)
- numpy (2.3.4)
- plotly (6.4.0)
- matplotlib (3.10.7)
- seaborn (0.13.2)
- openpyxl (3.1.5)
- scipy (1.16.3)
- scikit-learn (1.7.2)

### アプリの実行

venv環境を有効化した後、以下のコマンドでアプリを実行します：

```powershell
# FRディレクトリから実行する場合
cd FR
streamlit run app.py

# または、python/streamlitディレクトリから実行する場合
cd python/streamlit
streamlit run FR/app.py
```

## プロジェクト構造

```
FR/
├── Logistic.csv              # 経費管理データ（CSV形式）
├── Logistic.xlsx             # 経費管理データ（Excel形式）
├── dashboard-design.md       # ダッシュボード設計書
├── README.md                 # このファイル
└── app.py                    # Streamlitアプリケーション（作成予定）
```

## データ構造

CSVファイルには以下のカラムが含まれています：
- Date: 日付
- Vendor: ベンダー/支払先
- Description: 説明
- EXP: 支出金額
- E&E Date: 支払期限日
- Faculty: 教員関連
- Official: 公式関連
- カテゴリ列: Travel, Per Diem, Bks/Jrnls/AV, EQUIP, Other, Commun., Supplies/Misc, Short-term consultants

## 実装状況

✅ **ステップ1（ミニマム版）**: 完了
- トップページ（概要ダッシュボード）
- 詳細データ探索ページ
- 基本的なフィルター機能

✅ **ステップ2（機能追加版）**: 完了
- 時系列分析ページ
- カテゴリ分析ページ
- ベンダー分析ページ
- KPI指標8個への拡張

✅ **ステップ3（完全版）**: 完了
- 支出分析ページ（パレート分析、ローレンツ曲線含む）
- 月別比較分析ページ（ヒートマップ含む）
- カテゴリ×ベンダー分析ページ
- 既存ページの拡張（四半期別、季節性分析など）
- Excelエクスポート機能
- 期間プリセット機能

詳細は`dashboard-design.md`を参照してください。

## 実装された機能

### 8つの分析ページ

1. **📊 概要ダッシュボード**
   - KPI指標8個（総支出額、平均月間支出、総取引件数、平均取引額、最大/最小支出額、カテゴリ数、ベンダー数）
   - 月別トレンドグラフ
   - カテゴリ別・ベンダー別の主要インサイト

2. **📅 時系列分析**
   - 月別トレンド（総支出、平均取引額、取引件数）
   - 累積支出推移
   - 年別比較
   - 四半期別トレンド
   - 季節性分析（月別平均、曜日別）

3. **📁 カテゴリ分析**
   - カテゴリ別KPI
   - カテゴリ別の詳細分析グラフ
   - カテゴリ別の月別推移
   - カテゴリ別の支出分布（箱ひげ図）
   - カテゴリ×月別のヒートマップ

4. **🏢 ベンダー分析**
   - ベンダー別KPI
   - トップベンダー分析
   - 主要ベンダーの月別推移
   - ベンダー×カテゴリのヒートマップ
   - 主要ベンダーのカテゴリ内訳

5. **💰 支出分析**
   - 支出メトリクス6個
   - 支出分布（ヒストグラム、累積分布）
   - 金額帯別分析
   - 高額取引トップ10
   - パレート分析・ローレンツ曲線

6. **📆 月別比較分析**
   - 月別KPI（前月比含む）
   - 月別総支出（前月比で色分け）
   - 月別のカテゴリ構成比
   - 月別のカテゴリ別支出ヒートマップ

7. **🔗 カテゴリ×ベンダー分析**
   - カテゴリ×ベンダーマトリックス（ヒートマップ）
   - 主要カテゴリのベンダー分析
   - 主要ベンダーのカテゴリ分析

8. **🔍 詳細データ探索**
   - 検索機能（ベンダー名、説明文）
   - 複数カラムソート
   - データテーブル表示
   - CSV/Excelエクスポート

### サイドバーフィルター

- **期間フィルター**: 日付範囲選択 + プリセット（全期間、今月、先月、四半期、年間）
- **カテゴリフィルター**: 複数選択可能
- **ベンダーフィルター**: 複数選択可能
- **支出金額フィルター**: スライダーで範囲指定

