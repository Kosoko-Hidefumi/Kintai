# YouTube競合チャンネル分析ツール - 要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名
YouTube競合チャンネル分析ツール

### 1.2 開発環境
- **プラットフォーム**: Google Apps Script
- **データ保存先**: Google スプレッドシート
- **外部API**: YouTube Data API v3

### 1.3 目的
複数の競合YouTubeチャンネルの情報を自動収集し、スプレッドシートに一元管理することで、競合分析や市場調査を効率化する。

---

## 2. システム概要

### 2.1 システムの役割
- 競合チャンネルのリストを管理
- 各チャンネルの基本情報を自動取得
- 各チャンネルの動画一覧情報を自動取得
- 取得したデータをスプレッドシートに整理して出力

### 2.2 利用者
- YouTubeチャンネル運営者
- マーケティング担当者
- コンテンツ戦略立案者

---

## 3. 機能要件

### 3.1 チャンネル情報取得機能

#### 3.1.1 対象データ
競合チャンネルの以下の情報を取得する：

| データ項目 | 説明 | 優先度 |
|-----------|------|--------|
| チャンネルID | YouTubeチャンネルの一意識別子 | 必須 |
| チャンネル名 | チャンネルの表示名 | 必須 |
| 説明文 | チャンネルの説明 | 必須 |
| 登録者数 | 現在の登録者数 | 必須 |
| 総視聴回数 | チャンネル全体の累計視聴回数 | 必須 |
| 動画数 | 公開されている動画の総数 | 必須 |
| 開設日 | チャンネルの作成日 | 必須 |
| サムネイルURL | チャンネルのサムネイル画像URL | 推奨 |
| カスタムURL | カスタムURL（設定されている場合） | 推奨 |
| 国 | チャンネルの国設定 | 推奨 |
| 取得日時 | データを取得した日時 | 必須 |

#### 3.1.2 入力方法
- スプレッドシートの「チャンネルリスト」シートに競合チャンネルのIDまたはURLを入力
- 複数チャンネルの一括処理に対応

#### 3.1.3 出力先
- 「チャンネル情報」シートに一覧形式で出力

### 3.2 動画情報取得機能

#### 3.2.1 対象データ
各チャンネルの動画について、以下の情報を取得する：

| データ項目 | 説明 | 優先度 |
|-----------|------|--------|
| チャンネル名 | 動画が属するチャンネル名 | 必須 |
| 動画ID | YouTubeの動画識別子 | 必須 |
| 動画タイトル | 動画のタイトル | 必須 |
| 説明文 | 動画の説明 | 必須 |
| 公開日時 | 動画の公開日時 | 必須 |
| 視聴回数 | 現在の視聴回数 | 必須 |
| 高評価数 | 高評価の数 | 必須 |
| コメント数 | コメントの数 | 必須 |
| 再生時間 | 動画の長さ（秒） | 必須 |
| タグ | 動画に設定されているタグ | 推奨 |
| サムネイルURL | 動画のサムネイル画像URL | 推奨 |
| カテゴリID | 動画のカテゴリ | 推奨 |
| 動画URL | 動画への直接リンク | 必須 |
| 取得日時 | データを取得した日時 | 必須 |

#### 3.2.2 取得範囲
- デフォルト: 各チャンネルの最新50件の動画
- オプション: 取得件数を設定可能（最大50件/回）
- オプション: 公開日範囲を指定可能

#### 3.2.3 出力先
- 「動画情報」シートに一覧形式で出力

### 3.3 実行制御機能

#### 3.3.1 メニュー機能
スプレッドシートのカスタムメニューから以下の操作を実行可能にする：

1. **チャンネル情報を取得**
   - チャンネルリストから全チャンネルの基本情報を取得
   
2. **動画情報を取得**
   - 登録されている全チャンネルの動画情報を取得
   
3. **すべて実行**
   - チャンネル情報と動画情報を連続して取得
   
4. **データをクリア**
   - 取得済みデータをクリア（確認ダイアログ表示）

#### 3.3.2 エラーハンドリング
- API制限超過時の適切なエラーメッセージ表示
- 無効なチャンネルIDの検出とスキップ
- 処理中断時のログ記録

---

## 4. データ構造

### 4.1 スプレッドシート構成

スプレッドシートは以下の3つのシートで構成される：

#### 4.1.1 「設定」シート

| 列 | 項目名 | データ型 | 説明 |
|----|--------|---------|------|
| A | 設定項目 | 文字列 | 設定の名称 |
| B | 値 | 文字列/数値 | 設定値 |

**必須設定項目**:
- YouTube API Key: YouTube Data APIのAPIキー
- 取得動画数: 1チャンネルあたりの取得動画数（デフォルト: 50）

#### 4.1.2 「チャンネルリスト」シート

| 列 | 項目名 | データ型 | 必須 | 説明 |
|----|--------|---------|------|------|
| A | チャンネルID | 文字列 | ○ | YouTubeチャンネルID |
| B | メモ | 文字列 | - | 管理用メモ（競合の名称など） |
| C | 有効/無効 | チェックボックス | ○ | データ取得対象とするか |

#### 4.1.3 「チャンネル情報」シート

| 列 | 項目名 | データ型 | 説明 |
|----|--------|---------|------|
| A | 取得日時 | 日時 | データ取得日時 |
| B | チャンネルID | 文字列 | チャンネルID |
| C | チャンネル名 | 文字列 | チャンネル名 |
| D | 登録者数 | 数値 | 登録者数 |
| E | 総視聴回数 | 数値 | 累計視聴回数 |
| F | 動画数 | 数値 | 公開動画数 |
| G | 開設日 | 日付 | チャンネル開設日 |
| H | カスタムURL | 文字列 | カスタムURL |
| I | 説明文 | 文字列 | チャンネル説明 |
| J | 国 | 文字列 | 国設定 |
| K | サムネイルURL | 文字列 | サムネイル画像URL |
| L | チャンネルURL | 文字列 | チャンネルへのリンク |

#### 4.1.4 「動画情報」シート

| 列 | 項目名 | データ型 | 説明 |
|----|--------|---------|------|
| A | 取得日時 | 日時 | データ取得日時 |
| B | チャンネル名 | 文字列 | チャンネル名 |
| C | チャンネルID | 文字列 | チャンネルID |
| D | 動画ID | 文字列 | 動画ID |
| E | 動画タイトル | 文字列 | 動画タイトル |
| F | 公開日時 | 日時 | 公開日時 |
| G | 視聴回数 | 数値 | 視聴回数 |
| H | 高評価数 | 数値 | 高評価数 |
| I | コメント数 | 数値 | コメント数 |
| J | 再生時間（秒） | 数値 | 動画の長さ |
| K | 再生時間（表示） | 文字列 | HH:MM:SS形式 |
| L | タグ | 文字列 | カンマ区切り |
| M | カテゴリID | 数値 | カテゴリID |
| N | 説明文 | 文字列 | 動画説明 |
| O | サムネイルURL | 文字列 | サムネイル画像URL |
| P | 動画URL | 文字列 | 動画へのリンク |

---

## 5. 技術要件

### 5.1 YouTube Data API

#### 5.1.1 必要なAPIエンドポイント

1. **Channels.list**
   - 用途: チャンネル情報の取得
   - パラメータ: 
     - part: snippet,statistics,contentDetails
     - id: チャンネルID

2. **PlaylistItems.list**
   - 用途: チャンネルのアップロード動画リスト取得
   - パラメータ:
     - part: snippet,contentDetails
     - playlistId: アップロードプレイリストID
     - maxResults: 50

3. **Videos.list**
   - 用途: 動画の詳細情報取得
   - パラメータ:
     - part: snippet,statistics,contentDetails
     - id: 動画ID（カンマ区切りで最大50件）

#### 5.1.2 API制限
- **クォータ**: 1日あたり10,000ユニット（デフォルト）
- **レート制限**: 100リクエスト/100秒/ユーザー
- **コスト概算**:
  - Channels.list: 1ユニット
  - PlaylistItems.list: 1ユニット
  - Videos.list: 1ユニット

### 5.2 Google Apps Script

#### 5.2.1 必要なサービス
- SpreadsheetApp: スプレッドシート操作
- UrlFetchApp: YouTube API呼び出し
- Utilities: JSON解析、日時処理

#### 5.2.2 実行時間制限
- 標準アカウント: 6分/実行
- 対策: 大量データ処理時は分割実行

---

## 6. 処理フロー

### 6.1 チャンネル情報取得フロー

```
1. スプレッドシート「設定」シートからAPIキーを取得
2. 「チャンネルリスト」シートから有効なチャンネルIDを取得
3. 各チャンネルIDに対して:
   3.1. YouTube Data API (Channels.list) を呼び出し
   3.2. レスポンスからチャンネル情報を抽出
   3.3. データを整形
   3.4. エラーチェック
4. 「チャンネル情報」シートをクリア（ヘッダー行を除く）
5. 取得したデータを「チャンネル情報」シートに書き込み
6. 完了メッセージを表示
```

### 6.2 動画情報取得フロー

```
1. スプレッドシート「設定」シートからAPIキーと取得動画数を取得
2. 「チャンネルリスト」シートから有効なチャンネルIDを取得
3. 各チャンネルIDに対して:
   3.1. YouTube Data API (Channels.list) でアップロードプレイリストIDを取得
   3.2. PlaylistItems.list でプレイリスト内の動画IDリストを取得
   3.3. 動画IDを50件ずつバッチにまとめる
   3.4. Videos.list で動画の詳細情報を取得
   3.5. レスポンスから動画情報を抽出
   3.6. データを整形（再生時間の変換など）
4. 「動画情報」シートをクリア（ヘッダー行を除く）
5. 取得したデータを「動画情報」シートに書き込み
6. 完了メッセージを表示
```

### 6.3 初期セットアップフロー

```
1. スプレッドシート新規作成または既存ファイルを開く
2. 必要なシート（設定、チャンネルリスト、チャンネル情報、動画情報）を作成
3. 各シートにヘッダー行を設定
4. 「設定」シートに初期設定項目を記入
5. カスタムメニューを追加
6. 使い方の説明を表示
```

---

## 7. 非機能要件

### 7.1 パフォーマンス
- 10チャンネルの情報取得: 1分以内
- 10チャンネル×50動画の情報取得: 3分以内

### 7.2 保守性
- 関数は単一責任の原則に従う
- 適切なコメントを記載
- 設定値はハードコーディングせず、設定シートから読み込む

### 7.3 拡張性
- 今後の機能追加を考慮した設計
- APIレスポンスの変更に柔軟に対応できる構造

---

## 8. 制約事項

### 8.1 技術的制約
- YouTube Data API v3の利用制限（1日10,000クォータ）
- Google Apps Scriptの実行時間制限（6分）
- 一度に取得できる動画数の上限（50件/チャンネル/実行）

### 8.2 データ制約
- 非公開・限定公開動画は取得不可
- リアルタイムデータではなく、実行時点のスナップショット
- 過去データの履歴管理は含まれない（別途実装が必要）

---

## 9. セキュリティ要件

### 9.1 APIキー管理
- APIキーはスプレッドシートの「設定」シートに保存
- スプレッドシートの共有設定に注意
- 推奨: PropertiesServiceを使用した安全な保存（将来的な改善）

### 9.2 データアクセス
- スプレッドシートの閲覧権限を持つユーザーのみがデータにアクセス可能

---

## 10. 今後の拡張可能性

### 10.1 Phase 2（将来的な機能）
- データの定期自動取得（トリガー機能）
- 履歴データの保存と推移分析
- グラフ・レポート自動生成
- より詳細な動画分析（エンゲージメント率など）
- コメント情報の取得

### 10.2 Phase 3（将来的な機能）
- 複数のスプレッドシートへのエクスポート
- Webダッシュボード化
- 通知機能（特定条件達成時のメール送信など）
- 競合との比較分析機能

---

## 11. 用語集

| 用語 | 説明 |
|------|------|
| チャンネルID | YouTubeチャンネルの一意識別子（例: UC...で始まる24文字） |
| 動画ID | YouTube動画の一意識別子（例: 11文字の英数字） |
| プレイリストID | YouTubeプレイリストの一意識別子 |
| アップロードプレイリスト | チャンネルがアップロードした全動画を含む自動生成プレイリスト |
| クォータ | YouTube Data APIの使用量制限単位 |

---

## 12. 開発優先順位

### Priority 1（必須機能）
1. スプレッドシート初期設定
2. チャンネル情報取得機能
3. 基本的なエラーハンドリング

### Priority 2（重要機能）
4. 動画情報取得機能
5. カスタムメニュー実装
6. データクリア機能

### Priority 3（推奨機能）
7. 詳細なエラーメッセージ
8. 進捗表示
9. 取得件数の設定機能

---

## 13. 参考情報

### 13.1 YouTube Data API ドキュメント
- 公式ドキュメント: https://developers.google.com/youtube/v3
- APIキー取得方法: Google Cloud Consoleでプロジェクト作成

### 13.2 Google Apps Script ドキュメント
- 公式ドキュメント: https://developers.google.com/apps-script

---

**文書バージョン**: 1.0  
**作成日**: 2025-11-07  
**最終更新日**: 2025-11-07  
**ステータス**: 承認待ち

