# YouTube競合チャンネル分析ツール

競合YouTubeチャンネルの情報と動画データを自動収集し、Googleスプレッドシートに一元管理するツールです。

## 📋 概要

このツールを使用すると、以下のことができます：

- 📊 **複数の競合チャンネル情報を一括取得**  
  登録者数、総視聴回数、動画数、開設日などの統計データを取得

- 🎬 **各チャンネルの動画情報を詳細に分析**  
  タイトル、視聴回数、高評価数、コメント数、再生時間などを取得（最大50件/チャンネル）

- 📈 **スプレッドシートで一元管理**  
  取得したデータをスプレッドシートに整理して表示、分析が容易

## ✨ 主な機能

### チャンネル情報取得（12項目）
- 取得日時
- チャンネルID / チャンネル名
- 登録者数 / 総視聴回数 / 動画数
- 開設日
- カスタムURL / 説明文 / 国
- サムネイルURL / チャンネルURL

### 動画情報取得（16項目）
- 取得日時
- チャンネル名 / チャンネルID
- 動画ID / 動画タイトル
- 公開日時
- 視聴回数 / 高評価数 / コメント数
- 再生時間（秒） / 再生時間（表示形式）
- タグ / カテゴリID / 説明文
- サムネイルURL / 動画URL

### 便利な機能
- ✅ 使いやすいカスタムメニュー（絵文字アイコン付き）
- ✅ 進捗表示（Toast通知）
- ✅ データクリア機能（確認ダイアログ付き）
- ✅ エラーハンドリング
- ✅ 自動書式設定（数値のカンマ区切り、日付フォーマット）

## 🚀 セットアップ手順

### 1. スプレッドシートを作成

1. 新規Googleスプレッドシートを作成
2. スプレッドシート名を「YouTube競合分析」に変更（任意）

### 2. Apps Scriptエディタを開く

1. スプレッドシートのメニューから「拡張機能」→「Apps Script」を選択
2. プロジェクト名を「YouTubeCompetitorAnalysis」に変更（任意）

### 3. コードをコピー

1. このリポジトリの `コード.js` の内容をすべてコピー
2. Apps Scriptエディタに貼り付け（既存のコードを置き換え）
3. 💾 保存（Ctrl+S または ⌘+S）

### 4. YouTube Data API v3を有効化

1. Apps Scriptエディタの左側にある「サービス」の横の「+」をクリック
2. 「YouTube Data API」を選択
3. バージョン「v3」を選択
4. 識別子は「YouTube」のまま
5. 「追加」をクリック

### 5. 初期セットアップを実行

1. Apps Scriptエディタの関数選択で「setupSpreadsheet」を選択
2. 実行ボタン（▶️）をクリック
3. **初回のみ権限承認が必要です**：
   - 「承認が必要です」ダイアログで「権限を確認」をクリック
   - Googleアカウントを選択
   - 「詳細」→「YouTubeCompetitorAnalysis（安全ではないページ）に移動」をクリック
   - 「許可」をクリック
4. 実行が完了すると、4つのシートが自動作成されます

### 6. チャンネルIDを登録

1. スプレッドシートの「チャンネルリスト」シートを開く
2. A列にYouTubeチャンネルIDを入力
   - チャンネルIDの見つけ方：
     - チャンネルページのURLから取得（例: `UC...` で始まる24文字）
     - YouTubeチャンネル → 「チャンネルについて」→ URL をコピー
3. B列にメモ（競合の名称など）を入力（任意）
4. C列の「有効」にチェックを入れる（データ取得対象にする場合）

### 7. データ取得を実行

1. スプレッドシートを再読み込み（F5 または ⌘+R）
2. メニューバーに「📊 YouTube分析」が表示されます
3. 以下のいずれかを選択：
   - **📺 チャンネル情報を取得** - チャンネルの基本情報のみ
   - **🎬 動画情報を取得** - 動画の詳細情報のみ
   - **🔄 すべて実行** - チャンネル情報と動画情報を連続取得（推奨）

## 📖 使い方

### カスタムメニュー

スプレッドシートを開くと、メニューバーに「📊 YouTube分析」が表示されます。

| メニュー項目 | 説明 |
|------------|------|
| 📺 チャンネル情報を取得 | 登録済みチャンネルの基本情報を取得 |
| 🎬 動画情報を取得 | 各チャンネルの動画情報を取得（最大50件/チャンネル） |
| 🔄 すべて実行 | チャンネル情報と動画情報を連続して取得 |
| 🗑️ データをクリア | 取得済みデータをすべてクリア（確認あり） |
| ⚙️ 初期セットアップ | シートを再作成（初回セットアップと同じ） |

### チャンネルIDの取得方法

#### 方法1: チャンネルURLから取得
```
https://www.youtube.com/channel/UC1234567890abcdefghijklmn
                              ↑この部分がチャンネルID
```

#### 方法2: カスタムURLの場合
1. チャンネルページを開く
2. 「チャンネルについて」タブをクリック
3. 「統計情報を表示」の下にチャンネルIDが表示されます

### 設定のカスタマイズ

「設定」シートで以下を変更できます：

| 設定項目 | デフォルト値 | 説明 |
|---------|------------|------|
| 取得動画数 | 50 | 1チャンネルあたりの取得動画数（最大50） |

## 📊 データシート構成

### 1. 設定シート
ツールの動作設定を管理

### 2. チャンネルリストシート
競合チャンネルIDを登録・管理

### 3. チャンネル情報シート
取得したチャンネルの基本情報を表示

### 4. 動画情報シート
取得した動画の詳細情報を表示

## ⚡ パフォーマンス

- **チャンネル情報取得**: 10チャンネルで約10秒
- **動画情報取得**: 10チャンネル×50動画で約2-3分
- **すべて実行**: 10チャンネルで約2-3分

※ APIのレート制限を考慮して適切な待機時間を設けています

## 🔒 セキュリティ・制約事項

### セキュリティ
- APIキーは不要（Apps ScriptのYouTube Data APIサービスを使用）
- スプレッドシートの共有設定に注意してください
- 権限はスプレッドシートとYouTube Dataのみ

### 制約事項
- **YouTube Data API制限**: 1日10,000クォータ（無料枠）
- **Apps Script実行時間制限**: 6分/実行（無料アカウント）
- **取得動画数**: 最大50件/チャンネル/実行
- **非公開動画**: 取得できません
- **データの性質**: 実行時点のスナップショット（履歴管理なし）

## 🐛 トラブルシューティング

### エラー: 「必要なシートが揃っていません」
**原因**: シートが削除または名前が変更されている  
**解決法**: メニューから「⚙️ 初期セットアップ」を実行

### エラー: 「チャンネルリストが空です」
**原因**: チャンネルリストシートにデータが入力されていない  
**解決法**: チャンネルリストシートにチャンネルIDを入力し、「有効」にチェック

### エラー: 「有効なチャンネルが見つかりません」
**原因**: 「有効」列にチェックが入っていない  
**解決法**: チャンネルリストシートのC列（有効）にチェックを入れる

### エラー: 「ReferenceError: YouTube is not defined」
**原因**: YouTube Data API v3サービスが追加されていない  
**解決法**: セットアップ手順4を再確認してサービスを追加

### データが取得できない
**確認事項**:
1. チャンネルIDが正しいか確認
2. チャンネルが公開されているか確認
3. YouTube Data APIのクォータを確認（Google Cloud Consoleで確認可能）

### 実行が途中で止まる
**原因**: 大量のチャンネル/動画で6分の実行時間制限を超えた  
**解決法**: チャンネル数を減らすか、複数回に分けて実行

## 💡 活用例

### 1. 競合チャンネル分析
- 競合の登録者数の推移を追跡（定期的に実行）
- 人気動画のパターンを分析
- 投稿頻度や動画の長さを比較

### 2. コンテンツ戦略立案
- 高視聴回数の動画のタイトルやタグを研究
- 効果的な投稿時間帯を分析
- カテゴリ別のパフォーマンスを比較

### 3. 市場調査
- 特定ジャンルの主要プレイヤーをリストアップ
- 市場全体のトレンドを把握
- 新興チャンネルの発見

## 🔮 今後の拡張予定

- [ ] データの定期自動取得（トリガー機能）
- [ ] 履歴データの保存と推移分析
- [ ] グラフ・レポート自動生成
- [ ] エンゲージメント率の計算
- [ ] コメント情報の取得
- [ ] Webダッシュボード化

## 📝 開発情報

### 使用技術
- **プラットフォーム**: Google Apps Script
- **API**: YouTube Data API v3
- **データストレージ**: Google Sheets

### バージョン
- **v1.0.0** (2025-11-07) - 初版リリース

### ファイル構成
```
youtube/
├── appsscript.json     # Apps Script設定ファイル
├── コード.js            # メインコード
├── 要件定義書.md        # 詳細な要件定義
├── 開発タスクリスト.md  # 開発タスク管理
└── README.md           # このファイル
```

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🙏 謝辞

- Google Apps Script
- YouTube Data API v3

## 📞 サポート

問題が発生した場合は、以下を確認してください：
1. このREADMEのトラブルシューティングセクション
2. `要件定義書.md` の詳細仕様
3. `開発タスクリスト.md` の実装状況

---

**作成日**: 2025-11-07  
**最終更新**: 2025-11-07  
**バージョン**: 1.0.0



